import{onCleanup as f}from"solid-js";import{isServer as h,getRequestEvent as m}from"solid-js/web";const l=[{type:"page",$component:{src:"src/routes/[...404].tsx?pick=default&pick=$css",build:()=>import("../_...404_.js"),import:()=>import("../_...404_.js")},path:"/*404",filePath:"/private/tmp/vinxi-repro/src/routes/[...404].tsx"},{type:"page",$component:{src:"src/routes/about.tsx?pick=default&pick=$css",build:()=>import("../about.js"),import:()=>import("../about.js")},path:"/about",filePath:"/private/tmp/vinxi-repro/src/routes/about.tsx"},{type:"page",$component:{src:"src/routes/index.tsx?pick=default&pick=$css",build:()=>import("../index.js"),import:()=>import("../index.js")},path:"/",filePath:"/private/tmp/vinxi-repro/src/routes/index.tsx"}],y=g(l.filter(s=>s.type==="page")),d=x(l.filter(s=>s.type==="api"));function b(s,n){const t=s.split("/").filter(Boolean);t:for(const e of d){const i=e.matchSegments;if(t.length<i.length||!e.wildcard&&t.length>i.length)continue;for(let o=0;o<i.length;o++){const c=i[o];if(c&&t[o]!==c)continue t}const p=e[`$${n}`];if(p==="skip"||p===void 0)return;const r={};for(const{type:o,name:c,index:a}of e.params)o===":"?r[c]=t[a]:r[c]=t.slice(a).join("/");return{handler:p,params:r}}}function g(s){function n(t,e,i,p){const r=Object.values(t).find(o=>i.startsWith(o.id+"/"));return r?(n(r.children||(r.children=[]),e,i.slice(r.id.length)),t):(t.push({...e,id:i,path:i.replace(/\/\([^)/]+\)/g,"")}),t)}return s.sort((t,e)=>t.path.length-e.path.length).reduce((t,e)=>n(t,e,e.path,e.path),[])}function x(s){return s.flatMap(n=>u(n.path).map(e=>({...n,path:e}))).map(v).sort((n,t)=>t.score-n.score)}function u(s){let n=/(\/?\:[^\/]+)\?/.exec(s);if(!n)return[s];let t=s.slice(0,n.index),e=s.slice(n.index+n[0].length);const i=[t,t+=n[1]];for(;n=/^(\/\:[^\/]+)\?/.exec(e);)i.push(t+=n[1]),e=e.slice(n[0].length);return u(e).reduce((p,r)=>[...p,...i.map(o=>o+r)],[])}function v(s){const n=s.path.split("/").filter(Boolean),t=[],e=[];let i=0,p=!1;for(const[r,o]of n.entries())if(o[0]===":"){const c=o.slice(1);i+=3,t.push({type:":",name:c,index:r}),e.push(null)}else o[0]==="*"?(i-=1,t.push({type:"*",name:o.slice(1),index:r}),p=!0):(i+=4,o.match(/^\(.+\)$/)||e.push(o));return{...s,score:i,params:t,matchSegments:e,wildcard:p}}function k(s){if(h){const n=m();n&&f(n.components.status(s))}return null}export{k as H,b as m,y as p};
