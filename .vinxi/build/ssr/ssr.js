import{isServer as x,getRequestEvent as M,createComponent as v,delegateEvents as Se,ssrElement as D,escape as q,mergeProps as Ee,ssr as L,ssrHydrationKey as I,useAssets as Ae,NoHydration as ne,HydrationScript as Pe,ssrAttribute as Ce,Hydration as Le,renderToStream as $e}from"solid-js/web";import{toWebRequest as Te,getRequestIP as ke,setResponseHeader as K,setResponseStatus as z,appendResponseHeader as Me,getResponseHeader as Oe,removeResponseHeader as qe,getCookie as Fe,setCookie as xe,eventHandler as Ie,sendRedirect as He,setHeader as Be}from"h3";import{M as Ne,T as je}from"./assets/index-770de009.js";import{getOwner as Ue,runWithOwner as _e,createMemo as S,createContext as re,createSignal as O,createRenderEffect as De,untrack as Y,useContext as Ke,on as se,startTransition as We,resetErrorBoundaries as G,createComponent as oe,children as ze,createRoot as Je,Show as ae,onCleanup as ie,lazy as Ve,Suspense as Xe,ErrorBoundary as Ye,sharedConfig as Q}from"solid-js";import{p as Ge,H as Qe,m as Ze}from"./assets/HttpStatusCode-41e17109.js";import{provideRequestEvent as et}from"solid-js/web/storage";function tt(){let e=new Set;function t(s){return e.add(s),()=>e.delete(s)}let n=!1;function r(s,o){if(n)return!(n=!1);const a={to:s,options:o,defaultPrevented:!1,preventDefault:()=>a.defaultPrevented=!0};for(const c of e)c.listener({...a,from:c.location,retry:i=>{i&&(n=!0),c.navigate(s,{...o,resolve:!1})}});return!a.defaultPrevented}return{subscribe:t,confirm:r}}const nt=/^(?:[a-z0-9]+:)?\/\//i,rt=/^\/+|(\/)\/+$/g;function F(e,t=!1){const n=e.replace(rt,"$1");return n?t||/^[?#]/.test(n)?n:"/"+n:""}function j(e,t,n){if(nt.test(t))return;const r=F(e),s=n&&F(n);let o="";return!s||t.startsWith("/")?o=r:s.toLowerCase().indexOf(r.toLowerCase())!==0?o=r+s:o=s,(o||"/")+F(t,!o)}function st(e,t){return F(e).replace(/\/*(\*.*)?$/g,"")+F(t)}function ce(e){const t={};return e.searchParams.forEach((n,r)=>{t[r]=n}),t}function ot(e,t,n){const[r,s]=e.split("/*",2),o=r.split("/").filter(Boolean),a=o.length;return c=>{const i=c.split("/").filter(Boolean),l=i.length-a;if(l<0||l>0&&s===void 0&&!t)return null;const f={path:a?"":"/",params:{}},h=y=>n===void 0?void 0:n[y];for(let y=0;y<a;y++){const b=o[y],d=i[y],u=b[0]===":",p=u?b.slice(1):b;if(u&&W(d,h(p)))f.params[p]=d;else if(u||!W(d,b))return null;f.path+=`/${d}`}if(s){const y=l?i.slice(-l).join("/"):"";if(W(y,h(s)))f.params[s]=y;else return null}return f}}function W(e,t){const n=r=>r.localeCompare(e,void 0,{sensitivity:"base"})===0;return t===void 0?!0:typeof t=="string"?n(t):typeof t=="function"?t(e):Array.isArray(t)?t.some(n):t instanceof RegExp?t.test(e):!1}function at(e){const[t,n]=e.pattern.split("/*",2),r=t.split("/").filter(Boolean);return r.reduce((s,o)=>s+(o.startsWith(":")?2:3),r.length-(n===void 0?0:1))}function le(e){const t=new Map,n=Ue();return new Proxy({},{get(r,s){return t.has(s)||_e(n,()=>t.set(s,S(()=>e()[s]))),t.get(s)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(e())}})}function ue(e){let t=/(\/?\:[^\/]+)\?/.exec(e);if(!t)return[e];let n=e.slice(0,t.index),r=e.slice(t.index+t[0].length);const s=[n,n+=t[1]];for(;t=/^(\/\:[^\/]+)\?/.exec(r);)s.push(n+=t[1]),r=r.slice(t[0].length);return ue(r).reduce((o,a)=>[...o,...s.map(c=>c+a)],[])}const it=100,ct=re(),V=re();function lt(e,t=""){const{component:n,load:r,children:s,metadata:o}=e,a=!s||Array.isArray(s)&&!s.length,c={key:e,component:n,load:r,metadata:o};return he(e.path).reduce((i,l)=>{for(const f of ue(l)){const h=st(t,f),y=a?h:h.split("/*",1)[0];i.push({...c,originalPath:f,pattern:y,matcher:ot(y,!a,e.matchFilters)})}return i},[])}function ut(e,t=0){return{routes:e,score:at(e[e.length-1])*1e4-t,matcher(n){const r=[];for(let s=e.length-1;s>=0;s--){const o=e[s],a=o.matcher(n);if(!a)return null;r.unshift({...a,route:o})}return r}}}function he(e){return Array.isArray(e)?e:[e]}function de(e,t="",n=[],r=[]){const s=he(e);for(let o=0,a=s.length;o<a;o++){const c=s[o];if(c&&typeof c=="object"){c.hasOwnProperty("path")||(c.path="");const i=lt(c,t);for(const l of i){n.push(l);const f=Array.isArray(c.children)&&c.children.length===0;if(c.children&&!f)de(c.children,l.pattern,n,r);else{const h=ut([...n],r.length);r.push(h)}n.pop()}}}return n.length?r:r.sort((o,a)=>a.score-o.score)}function fe(e,t){for(let n=0,r=e.length;n<r;n++){const s=e[n].matcher(t);if(s)return s}return[]}function ht(e,t){const n=new URL("http://sar"),r=S(i=>{const l=e();try{return new URL(l,n)}catch{return console.error(`Invalid path ${l}`),i}},n,{equals:(i,l)=>i.href===l.href}),s=S(()=>r().pathname),o=S(()=>r().search,!0),a=S(()=>r().hash),c=()=>"";return{get pathname(){return s()},get search(){return o()},get hash(){return a()},get state(){return t()},get key(){return c()},query:le(se(o,()=>ce(r())))}}let C;function dt(e,t,n={}){const{signal:[r,s],utils:o={}}=e,a=o.parsePath||(m=>m),c=o.renderPath||(m=>m),i=o.beforeLeave||tt(),l=j("",n.base||"");if(l===void 0)throw new Error(`${l} is not a valid base path`);l&&!r().value&&s({value:l,replace:!0,scroll:!1});const[f,h]=O(!1),y=async m=>{h(!0);try{await We(m)}finally{h(!1)}},[b,d]=O(r().value),[u,p]=O(r().state),g=ht(b,u),E=[],R=O(x?Re():[]),$={pattern:l,params:{},path:()=>l,outlet:()=>null,resolvePath(m){return j(l,m)}};return De(()=>{const{value:m,state:w}=r();Y(()=>{m!==b()&&y(()=>{C="native",d(m),p(w),G(),R[1]([])}).then(()=>{C=void 0})})}),{base:$,location:g,isRouting:f,renderPath:c,parsePath:a,navigatorFactory:ve,beforeLeave:i,preloadRoute:be,submissions:R};function H(m,w,A){Y(()=>{if(typeof w=="number"){w&&(o.go?i.confirm(w,A)&&o.go(w):console.warn("Router integration does not support relative routing"));return}const{replace:B,resolve:_,scroll:P,state:k}={replace:!1,resolve:!0,scroll:!0,...A},T=_?m.resolvePath(w):j("",w);if(T===void 0)throw new Error(`Path '${w}' is not a routable path`);if(E.length>=it)throw new Error("Too many redirects");const X=b();if(T!==X||k!==u()){if(x){const N=M();N&&(N.response=new Response(null,{status:302,headers:{Location:T}})),s({value:T,replace:B,scroll:P,state:k})}else if(i.confirm(T,A)){const N=E.push({value:X,replace:B,scroll:P,state:u()});y(()=>{C="navigate",d(T),p(k),G(),R[1]([])}).then(()=>{E.length===N&&(C=void 0,we({value:T,state:k}))})}}})}function ve(m){return m=m||Ke(V)||$,(w,A)=>H(m,w,A)}function we(m){const w=E[0];w&&((m.value!==w.value||m.state!==w.state)&&s({...m,replace:w.replace,scroll:w.scroll}),E.length=0)}function be(m,w){const A=fe(t(),m.pathname),B=C;C="preload";for(let _ in A){const{route:P,params:k}=A[_];P.component&&P.component.preload&&P.component.preload(),w&&P.load&&P.load({params:k,location:{pathname:m.pathname,search:m.search,hash:m.hash,query:ce(m),state:null,key:""},intent:"preload"})}C=B}function Re(){const m=M();return m&&m.initialSubmission?[m.initialSubmission]:[]}}function ft(e,t,n,r,s){const{base:o,location:a}=e,{pattern:c,component:i,load:l}=r().route,f=S(()=>r().path);i&&i.preload&&i.preload();const h=l?l({params:s,location:a,intent:C||"initial"}):void 0;return{parent:t,pattern:c,path:f,params:s,outlet:()=>i?oe(i,{params:s,location:a,data:h,get children(){return n()}}):n(),resolvePath(b){return j(o.path(),b,f())}}}const me=e=>t=>{const{base:n}=t,r=ze(()=>t.children),s=S(()=>de(t.root?{component:t.root,children:r()}:r(),t.base||"")),o=dt(e,s,{base:n});return e.create&&e.create(o),v(ct.Provider,{value:o,get children(){return v(mt,{routerState:o,get branches(){return s()}})}})};function mt(e){const t=S(()=>fe(e.branches,e.routerState.location.pathname));if(x){const a=M();a&&(a.routerMatches||(a.routerMatches=[])).push(t().map(({route:c,path:i,params:l})=>({path:c.originalPath,pattern:c.pattern,match:i,params:l,metadata:c.metadata})))}const n=le(()=>{const a=t(),c={};for(let i=0;i<a.length;i++)Object.assign(c,a[i].params);return c}),r=[];let s;const o=S(se(t,(a,c,i)=>{let l=c&&a.length===c.length;const f=[];for(let h=0,y=a.length;h<y;h++){const b=c&&c[h],d=a[h];i&&b&&d.route.key===b.route.key?f[h]=i[h]:(l=!1,r[h]&&r[h](),Je(u=>{r[h]=u,f[h]=ft(e.routerState,f[h-1]||e.routerState.base,pt(()=>o()[h+1]),()=>t()[h],n)}))}return r.splice(a.length).forEach(h=>h()),i&&l?i:(s=f[0],f)}));return v(ae,{get when(){return o()&&s},keyed:!0,children:a=>v(V.Provider,{value:a,get children(){return a.outlet()}})})}const pt=e=>()=>v(ae,{get when(){return e()},keyed:!0,children:t=>v(V.Provider,{value:t,get children(){return t.outlet()}})});function gt([e,t],n,r){return[n?()=>n(e()):e,r?s=>t(r(s)):t]}function yt(e){if(e==="#")return null;try{return document.querySelector(e)}catch{return null}}function vt(e){let t=!1;const n=s=>typeof s=="string"?{value:s}:s,r=gt(O(n(e.get()),{equals:(s,o)=>s.value===o.value}),void 0,s=>(!t&&e.set(s),s));return e.init&&ie(e.init((s=e.get())=>{t=!0,r[1](n(s)),t=!1})),me({signal:r,create:e.create,utils:e.utils})}function wt(e,t,n){return e.addEventListener(t,n),()=>e.removeEventListener(t,n)}function bt(e,t){const n=yt(`#${e}`);n?n.scrollIntoView():t&&window.scrollTo(0,0)}function Rt(e){const t=new URL(e);return t.pathname+t.search}function St(e){let t;const n={value:e.url||(t=M())&&Rt(t.request.url)||""};return me({signal:[()=>n,r=>Object.assign(n,r)]})(e)}const Et=new Map;function At(e=!0,t=!1,n="/_server"){return r=>{const s=r.base.path(),o=r.navigatorFactory(r.base);let a={};function c(d){return d.namespaceURI==="http://www.w3.org/2000/svg"}function i(d){if(d.defaultPrevented||d.button!==0||d.metaKey||d.altKey||d.ctrlKey||d.shiftKey)return;const u=d.composedPath().find(H=>H instanceof Node&&H.nodeName.toUpperCase()==="A");if(!u||t&&!u.getAttribute("link"))return;const p=c(u),g=p?u.href.baseVal:u.href;if((p?u.target.baseVal:u.target)||!g&&!u.hasAttribute("state"))return;const R=(u.getAttribute("rel")||"").split(/\s+/);if(u.hasAttribute("download")||R&&R.includes("external"))return;const $=p?new URL(g,document.baseURI):new URL(g);if(!($.origin!==window.location.origin||s&&$.pathname&&!$.pathname.toLowerCase().startsWith(s.toLowerCase())))return[u,$]}function l(d){const u=i(d);if(!u)return;const[p,g]=u,E=r.parsePath(g.pathname+g.search+g.hash),R=p.getAttribute("state");d.preventDefault(),o(E,{resolve:!1,replace:p.hasAttribute("replace"),scroll:!p.hasAttribute("noscroll"),state:R&&JSON.parse(R)})}function f(d){const u=i(d);if(!u)return;const[p,g]=u;a[g.pathname]||r.preloadRoute(g,p.getAttribute("preload")!=="false")}function h(d){const u=i(d);if(!u)return;const[p,g]=u;a[g.pathname]||(a[g.pathname]=setTimeout(()=>{r.preloadRoute(g,p.getAttribute("preload")!=="false"),delete a[g.pathname]},200))}function y(d){const u=i(d);if(!u)return;const[,p]=u;a[p.pathname]&&(clearTimeout(a[p.pathname]),delete a[p.pathname])}function b(d){let u=d.submitter&&d.submitter.hasAttribute("formaction")?d.submitter.formAction:d.target.action;if(!u)return;if(!u.startsWith("action:")){const g=new URL(u);if(u=r.parsePath(g.pathname+g.search),!u.startsWith(n))return}if(d.target.method.toUpperCase()!=="POST")throw new Error("Only POST forms are supported for Actions");const p=Et.get(u);if(p){d.preventDefault();const g=new FormData(d.target);p.call(r,g)}}Se(["click","submit"]),document.addEventListener("click",l),e&&(document.addEventListener("mouseover",h),document.addEventListener("mouseout",y),document.addEventListener("focusin",f),document.addEventListener("touchstart",f)),document.addEventListener("submit",b),ie(()=>{document.removeEventListener("click",l),e&&(document.removeEventListener("mouseover",h),document.removeEventListener("mouseout",y),document.removeEventListener("focusin",f),document.removeEventListener("touchstart",f)),document.removeEventListener("submit",b)})}}function Pt(e){return x?St(e):vt({get:()=>({value:window.location.pathname+window.location.search+window.location.hash,state:history.state}),set({value:t,replace:n,scroll:r,state:s}){n?window.history.replaceState(s,"",t):window.history.pushState(s,"",t),bt(window.location.hash.slice(1),r)},init:t=>wt(window,"popstate",()=>t()),create:At(e.preload,e.explicitLinks,e.actionBase),utils:{go:t=>window.history.go(t)}})(e)}const Ct=" ",Lt={style:e=>D("style",e.attrs,()=>q(e.children),!0),link:e=>D("link",e.attrs,void 0,!0),script:e=>e.attrs.src?D("script",Ee(()=>e.attrs,{get id(){return e.key}}),()=>L(Ct),!0):null};function J(e){let{tag:t,attrs:{key:n,...r}={key:void 0},children:s}=e;return Lt[t]({attrs:r,key:n,children:s})}function $t(e,t,n,r="default"){return Ve(async()=>{{const o=(await e.import())[r],c=(await t.inputs?.[e.src].assets()).filter(l=>l.tag==="style"||l.attrs.rel==="stylesheet");return{default:l=>[...c.map(f=>J(f)),oe(o,l)]}}})}function pe(){function e(n){return{...n,...n.$$route?n.$$route.require().route:void 0,metadata:{...n.$$route?n.$$route.require().route.metadata:{},filesystem:!0},component:$t(n.$component,globalThis.MANIFEST.client,globalThis.MANIFEST.ssr),children:n.children?n.children.map(e):void 0}}return Ge.map(e)}let Z;const Tt=()=>x?M().routes:Z||(Z=pe());const kt=["<a",' href="/">Index</a>'],Mt=["<a",' href="/about">About</a>'];function Ot(){return v(Pt,{root:e=>v(Ne,{get children(){return[v(je,{children:"SolidStart - Basic"}),L(kt,I()),L(Mt,I()),v(Xe,{get children(){return e.children}})]}}),get children(){return v(Tt,{})}})}function qt(e){return v(Ye,{get fallback(){return v(Qe,{code:500})},get children(){return e.children}})}const Ft=["<script",">","<\/script>"],xt=["<script",' type="module" async',"><\/script>"],It=L("<!DOCTYPE html>");function Ht(e){const t=M();let n=[];return Promise.resolve().then(async()=>{let r=t.routes;if(t.routerMatches&&t.routerMatches[0])for(let s=0;s<t.routerMatches[0].length;s++){const o=t.routerMatches[0][s];if(o.metadata&&o.metadata.filesystem){const a=r.find(l=>l.path===o.path),i=await globalThis.MANIFEST.client.inputs[a.$component.src].assets();n.push.apply(n,i),r=a.children}}n=[...new Map(n.map(s=>[s.attrs.key,s])).values()].filter(s=>s.attrs.rel==="modulepreload"&&!t.assets.find(o=>o.attrs.key===s.attrs.key))}),Ae(()=>n.length?n.map(r=>J(r)):void 0),v(ne,{get children(){return[It,v(e.document,{get assets(){return[v(Pe,{}),t.assets.map(r=>J(r))]},get scripts(){return[L(Ft,I(),`window.manifest = ${JSON.stringify(t.manifest)}`),L(xt,I(),Ce("src",q(globalThis.MANIFEST.client.inputs[globalThis.MANIFEST.client.handler].output.path,!0),!1))]},get children(){return v(Le,{get children(){return v(qt,{get children(){return v(Ot,{})}})}})}})]}})}const ge=Symbol("h3Event"),U=Symbol("fetchEvent"),Bt={get(e,t){return t===U?e:e[t]??e[ge][t]}};function Nt(e){return new Proxy({request:Te(e),clientAddress:ke(e),locals:{},[ge]:e},Bt)}function jt(e){if(!e[U]){const t=Nt(e);e[U]=t}return e[U]}function Ut(e){const t=Fe(e,"flash");if(!t)return;let n=JSON.parse(t);if(!n||!n.result)return[];const r=[...n.input.slice(0,-1),new Map(n.input[n.input.length-1])];return xe(e,"flash","",{maxAge:0}),{url:n.url,result:n.error?new Error(n.result):n.result,input:r}}async function ye(e){const t=globalThis.MANIFEST.client;return globalThis.MANIFEST.ssr,K(e,"Content-Type","text/html"),Object.assign(e,{manifest:await t.json(),assets:[...await t.inputs[t.handler].assets()],initialSubmission:Ut(e),routes:pe(),components:{status:r=>(z(e,r.code,r.text),()=>z(e,200)),header:r=>(r.append?Me(e,r.name,r.value):K(e,r.name,r.value),()=>{const s=Oe(e,r.name);if(s&&typeof s=="string"){const o=s.split(", "),a=o.indexOf(r.value);a!==-1&&o.splice(a,1),o.length?K(e,r.name,o.join(", ")):qe(e,r.name)}})},$islands:new Set})}function _t(e,t={}){return Ie({onRequest:t.onRequest,onBeforeResponse:t.onBeforeResponse,handler:n=>{const r=jt(n);return et(r,async()=>{const s=Ze(new URL(r.request.url).pathname,r.request.method);if(s){const h=(await s.handler.import())[r.request.method];return r.params=s.params,Q.context={event:r},await h(r)}const o=await ye(r);let a={...t};if(a.onCompleteAll){const f=a.onCompleteAll;a.onCompleteAll=h=>{te(o)(h),f(h)}}else a.onCompleteAll=te(o);if(a.onCompleteShell){const f=a.onCompleteShell;a.onCompleteShell=h=>{ee(o,n)(),f(h)}}else a.onCompleteShell=ee(o,n);const c=$e(()=>(Q.context.event=o,e(o)),a);if(o.response&&o.response.headers.get("Location"))return He(r,o.response.headers.get("Location"));const{writable:i,readable:l}=new TransformStream;return c.pipeTo(i),l})}})}function ee(e,t){return()=>{e.response&&e.response.headers.get("Location")&&(z(t,302),Be(t,"Location",e.response.headers.get("Location")))}}function te(e){return({write:t})=>{const n=e.response&&e.response.headers.get("Location");n&&t(`<script>window.location="${n}"<\/script>`)}}function Dt(e,t={}){return _t(e,{...t,createPageEvent:ye})}const Kt=['<head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.ico">',"</head>"],Wt=["<html",' lang="en">','<body><div id="app">',"</div><!--$-->","<!--/--></body></html>"],Qt=Dt(()=>v(Ht,{document:({assets:e,children:t,scripts:n})=>L(Wt,I(),v(ne,{get children(){return L(Kt,q(e))}}),q(t),q(n))}));export{Qt as default};
